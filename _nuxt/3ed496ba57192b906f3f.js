(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{1304:function(e,r,t){"use strict";t.r(r);t(29);var o=t(3),l=t(374),n=t(5),m=t(6),c={asyncData:function(e){var r={invoiceType:"normal",titleType:"personal",invoiceTitle:"",registerAddress:"",registerPhone:"",bankName:"",bankNumber:"",taxNumber:"",receiverName:"",receiverPhone:"",receiverArea:"",provinceId:"",cityId:"",districtId:""},t=[];return e.query.params&&(t=[(r=JSON.parse(e.query.params)).provinceId||"",r.cityId||"",r.districtId||""]),{rules:{invoiceTitle:[{required:!0,message:"请输入单位名称",trigger:"blur"}],registerAddress:[{required:!0,message:"请输入单位地址",trigger:"blur"}],registerPhone:[{required:!0,message:"请输入单位电话",trigger:"blur"}],bankName:[{required:!0,message:"请输入开户银行",trigger:"blur"}],bankNumber:[{required:!0,message:"请输入银行账号",trigger:"blur"}],taxNumber:[{required:!0,message:"请输入税号",trigger:"blur"}],receiverName:[{required:!0,message:"请输入收票人姓名",trigger:"blur"}],receiverPhone:[{required:!0,message:"请输入收票人手机",trigger:"blur"},{min:11,max:11,message:"请输入正确位数的手机号",trigger:"blur"}],receiverArea:[{required:!0,message:"请输入收票人地区",trigger:"blur"}]},ruleForm:r,areaInfo:t}},components:{"v-cityPicker":l.a},data:function(){return{normalExlain:"*应国家税务局要求，所有单位公司发票必须开具税号，发票内容为实际购买的商品明细。",unitExlain:"*需开具增值税专用发票的顾客，需要提供以下材料并加盖公章： ①营业执照副本，②税务登记证副本复印件，③一般纳税人资格证书， ④银行开户许可证，⑤组织机构代码证。 请您将您的相关证件扫描之后，发送至邮箱：toolmall@toolmall.com，工作人员审核后将为您开具增值税发票。",areaInfo:[],isverfiyPhone:!0,ruleForm:{invoiceType:"normal",titleType:"personal",invoiceTitle:"",registerAddress:"",registerPhone:"",bankName:"",bankNumber:"",taxNumber:"",receiverName:"",receiverPhone:"",receiverArea:"",provinceId:"",cityId:"",districtId:""},errors:{areaInfo:"",receiverPhone:""},rules:{invoiceTitle:[{required:!0,message:"请输入单位名称",trigger:"blur"}],registerAddress:[{required:!0,message:"请输入单位地址",trigger:"blur"}],registerPhone:[{required:!0,message:"请输入单位电话",trigger:"blur"}],bankName:[{required:!0,message:"请输入开户银行",trigger:"blur"}],bankNumber:[{required:!0,message:"请输入银行账号",trigger:"blur"}],taxNumber:[{required:!0,message:"请输入税号",trigger:"blur"}],receiverName:[{required:!0,message:"请输入收票人姓名",trigger:"blur"}],receiverPhone:[{required:!0,message:"请输入收票人手机",trigger:"blur"},{min:11,max:11,message:"请输入正确位数的手机号",trigger:"blur"}],receiverArea:[{required:!0,message:"请输入收票人地区",trigger:"blur"}]}}},computed:{},mounted:function(){this.getData()},methods:{getData:function(){this.$route.query.params&&(this.ruleForm=JSON.parse(this.$route.query.params),this.areaInfo=[this.ruleForm.provinceId||"",this.ruleForm.cityId||"",this.ruleForm.districtId||""])},saveInvoice:function(e){var r=this;this.$refs[e].validate(function(e){return!!e&&(r.isverfiyPhone?r.areaInfo&&r.areaInfo.length>0?(r.errors.areaInfo="",r.validateType()):r.errors.areaInfo="请选择收票人地区":r.$message.error("请输入正确的手机号！"),!0)})},validateType:function(){"special"===this.ruleForm.invoiceType?this.checkInfo("specialForm"):"personal"==this.ruleForm.titleType?this.checkInfo("personalForm"):"company"==this.ruleForm.titleType&&this.checkInfo("companyForm")},checkInfo:function(e){var r=this;this.$refs[e].validate(function(e){e&&(r.ruleForm.invoiceId?r.updateInvoice(r.ruleForm):r.savedInvoice(r.ruleForm))})},savedInvoice:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(data){var r,t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=JSON.stringify(data),t=n.a.saveInvoiceUrl,e.next=4,Object(m.a)(this,t,r,"POST");case 4:e.sent&&(this.$message.success("新增发票成功！"),this.$router.go(-1));case 6:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}(),updateInvoice:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(data){var r,t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=JSON.stringify(data),t=n.a.updateInvoiceUrl,e.next=4,Object(m.a)(this,t,r,"POST");case 4:e.sent&&(this.$message.success("发票修改成功！"),this.$router.go(-1));case 6:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}(),changePhone:function(e){if(e&&e.length>0){/^[1][3,4,5,7,8][0-9]{9}$/.test(e)?(this.errors.receiverPhone="",this.isverfiyPhone=!0):(this.errors.receiverPhone="请输入正确格式的手机号码",this.isverfiyPhone=!1)}},onResultChange:function(e){this.ruleForm.provinceId=e[0],this.ruleForm.cityId=e[1],this.ruleForm.districtId=e[2]}}},v=(t(893),t(20)),component=Object(v.a)(c,function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[t("div",{staticClass:"niv_top"},[e._v("发票信息管理-新增发票")]),e._v(" "),t("div",{staticClass:"niv_new"},[t("div",{staticStyle:{"margin-left":"50px"}},[t("a",{on:{click:function(r){e.ruleForm.invoiceType="normal"}}},[t("span",{class:"normal"===e.ruleForm.invoiceType?"niv_normal_select":"niv_normal_noselect"},[e._v("增值税普通发票")])]),e._v(" "),t("a",{on:{click:function(r){e.ruleForm.invoiceType="special"}}},[t("span",{class:"special"===e.ruleForm.invoiceType?"niv_normal_select":"niv_normal_noselect",staticStyle:{"margin-left":"34px"}},[e._v("增值税专用发票")])])]),e._v(" "),t("div",[t("el-form",{directives:[{name:"show",rawName:"v-show",value:"special"!=e.ruleForm.invoiceType,expression:"ruleForm.invoiceType != 'special'"}],ref:"ruleForm",staticClass:"ruleForm niv_form1",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{ref:"invoiceTitle",attrs:{label:"开具对象:"}},[t("el-radio",{attrs:{label:"personal"},model:{value:e.ruleForm.titleType,callback:function(r){e.$set(e.ruleForm,"titleType",r)},expression:"ruleForm.titleType"}},[e._v("个人")]),e._v(" "),t("el-radio",{attrs:{label:"company"},model:{value:e.ruleForm.titleType,callback:function(r){e.$set(e.ruleForm,"titleType",r)},expression:"ruleForm.titleType"}},[e._v("单位")])],1)],1),e._v(" "),t("el-form",{directives:[{name:"show",rawName:"v-show",value:"special"!=e.ruleForm.invoiceType&&"personal"===e.ruleForm.titleType,expression:"ruleForm.invoiceType != 'special' && ruleForm.titleType === 'personal'"}],ref:"personalForm",staticClass:"ruleForm niv_form1",style:"special"===e.ruleForm.invoiceType?"margin-top:45px;":"margin-top:16px;",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{ref:"invoiceTitle",attrs:{label:"发票抬头:",prop:"invoiceTitle"}},[t("el-input",{attrs:{placeholder:"请输入发票抬头"},model:{value:e.ruleForm.invoiceTitle,callback:function(r){e.$set(e.ruleForm,"invoiceTitle",r)},expression:"ruleForm.invoiceTitle"}})],1)],1),e._v(" "),t("el-form",{directives:[{name:"show",rawName:"v-show",value:"special"!=e.ruleForm.invoiceType&&"company"===e.ruleForm.titleType,expression:"ruleForm.invoiceType != 'special' && ruleForm.titleType === 'company'"}],ref:"companyForm",staticClass:"ruleForm niv_form1",style:"special"===e.ruleForm.invoiceType?"margin-top:45px;":"margin-top:16px;",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{ref:"invoiceTitle",attrs:{label:"单位名称:",prop:"invoiceTitle"}},[t("el-input",{attrs:{placeholder:"请输入单位名称"},model:{value:e.ruleForm.invoiceTitle,callback:function(r){e.$set(e.ruleForm,"invoiceTitle",r)},expression:"ruleForm.invoiceTitle"}})],1),e._v(" "),t("el-form-item",{ref:"taxNumber",attrs:{label:"税号:",prop:"taxNumber"}},[t("el-input",{attrs:{placeholder:"请输入税号"},model:{value:e.ruleForm.taxNumber,callback:function(r){e.$set(e.ruleForm,"taxNumber",r)},expression:"ruleForm.taxNumber"}})],1)],1),e._v(" "),t("el-form",{directives:[{name:"show",rawName:"v-show",value:"special"===e.ruleForm.invoiceType,expression:"ruleForm.invoiceType === 'special'"}],ref:"specialForm",staticClass:"ruleForm niv_form1",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{ref:"invoiceTitle",attrs:{label:"单位名称:",prop:"invoiceTitle"}},[t("el-input",{attrs:{placeholder:"请输入单位名称"},model:{value:e.ruleForm.invoiceTitle,callback:function(r){e.$set(e.ruleForm,"invoiceTitle",r)},expression:"ruleForm.invoiceTitle"}})],1),e._v(" "),t("el-form-item",{ref:"registerAddress",attrs:{label:"单位地址:",prop:"registerAddress"}},[t("el-input",{attrs:{placeholder:"请输入单位地址"},model:{value:e.ruleForm.registerAddress,callback:function(r){e.$set(e.ruleForm,"registerAddress",r)},expression:"ruleForm.registerAddress"}})],1),e._v(" "),t("el-form-item",{ref:"registerPhone",attrs:{label:"单位电话:",prop:"registerPhone"}},[t("el-input",{attrs:{maxlength:"15",placeholder:"请输入单位电话"},model:{value:e.ruleForm.registerPhone,callback:function(r){e.$set(e.ruleForm,"registerPhone",r)},expression:"ruleForm.registerPhone"}})],1),e._v(" "),t("el-form-item",{ref:"bankName",attrs:{label:"开户银行:",prop:"bankName"}},[t("el-input",{attrs:{placeholder:"请输入开户银行"},model:{value:e.ruleForm.bankName,callback:function(r){e.$set(e.ruleForm,"bankName",r)},expression:"ruleForm.bankName"}})],1),e._v(" "),t("el-form-item",{ref:"bankNumber",attrs:{label:"银行账号:",prop:"bankNumber"}},[t("el-input",{attrs:{placeholder:"请输入银行账号"},model:{value:e.ruleForm.bankNumber,callback:function(r){e.$set(e.ruleForm,"bankNumber",r)},expression:"ruleForm.bankNumber"}})],1),e._v(" "),t("el-form-item",{ref:"taxNumber",attrs:{label:"税号:",prop:"taxNumber"}},[t("el-input",{attrs:{placeholder:"请输入税号"},model:{value:e.ruleForm.taxNumber,callback:function(r){e.$set(e.ruleForm,"taxNumber",r)},expression:"ruleForm.taxNumber"}})],1)],1),e._v(" "),t("div",{staticClass:"niv_explain"},[t("span",[e._v(e._s("special"!=e.ruleForm.invoiceType&&"company"===e.ruleForm.titleType?e.normalExlain:"special"===e.ruleForm.invoiceType?e.unitExlain:""))])]),e._v(" "),t("el-form",{ref:"publicForm",staticClass:"ruleForm niv_form2",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{ref:"receiverName",attrs:{label:"收票人姓名:",prop:"receiverName"}},[t("el-input",{attrs:{placeholder:"请输入收票人姓名"},model:{value:e.ruleForm.receiverName,callback:function(r){e.$set(e.ruleForm,"receiverName",r)},expression:"ruleForm.receiverName"}})],1),e._v(" "),t("el-form-item",{ref:"receiverPhone",attrs:{label:"收票人手机:",prop:"receiverPhone",error:e.errors.receiverPhone}},[t("customInput",{staticStyle:{width:"350px"},attrs:{inputType:"number",maxlength:"11",placeholder:"请输入收票人手机"},on:{change:e.changePhone},model:{value:e.ruleForm.receiverPhone,callback:function(r){e.$set(e.ruleForm,"receiverPhone",r)},expression:"ruleForm.receiverPhone"}})],1),e._v(" "),t("el-form-item",{ref:"registerPhone",attrs:{label:"收票人地区:",error:e.errors.areaInfo,required:""}},[t("v-cityPicker",{ref:"cityPicker",attrs:{value:e.areaInfo},on:{"on-change":e.onResultChange}})],1),e._v(" "),t("el-form-item",{ref:"receiverArea",attrs:{label:"详细地址:",prop:"receiverArea"}},[t("el-input",{attrs:{placeholder:"请输入详细地址"},model:{value:e.ruleForm.receiverArea,callback:function(r){e.$set(e.ruleForm,"receiverArea",r)},expression:"ruleForm.receiverArea"}})],1)],1)],1),e._v(" "),t("el-button",{staticClass:"niv_btn_save",attrs:{type:"primary"},on:{click:function(r){return e.saveInvoice("publicForm")}}},[e._v("保 存")])],1)])},[],!1,null,"6600afa6",null);component.options.__file="newinvoice.vue";r.default=component.exports},549:function(e,r,t){var content=t(894);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,t(19).default)("938781a2",content,!0,{sourceMap:!1})},893:function(e,r,t){"use strict";var o=t(549);t.n(o).a},894:function(e,r,t){(e.exports=t(18)(!1)).push([e.i,".niv_top[data-v-6600afa6]{border:1px solid #ececec;padding:11px 32px;font-weight:700;font-size:14px;color:#000}.niv_new[data-v-6600afa6]{margin-top:60px;margin-left:165px}.niv_normal_select[data-v-6600afa6]{padding:5px 11px;font-size:18px;color:#1368c3;border:1px solid #1368c3;border-radius:2px}.niv_normal_noselect[data-v-6600afa6]{padding:5px 11px;font-size:18px;color:#737373;border:1px solid #737373;border-radius:2px}.niv_form1[data-v-6600afa6]{width:450px;margin-top:45px}.niv_form2[data-v-6600afa6]{width:450px;margin-top:20px}.el-form-item[data-v-6600afa6] .el-form-item__label{font-size:14px!important;color:#333!important}.el-form[data-v-6600afa6] .el-form-item{margin-bottom:18px!important}.niv_explain[data-v-6600afa6]{font-size:14px;color:#e3211a}.niv_btn_save[data-v-6600afa6]{width:350px;height:45px;margin-top:70px;margin-left:100px;background:#1b6dc5;border-radius:2px;font-size:20px;color:#fff}",""])}}]);